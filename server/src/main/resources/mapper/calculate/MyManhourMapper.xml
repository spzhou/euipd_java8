<?xml version="1.0" encoding="UTF-8"?>
<!--
Author：周朔鹏
编制时间：2025-08-05
电子邮件：391902958@qq.com
项目官网：https://www.euipd.com
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.course.server.mapper.calculate.MyManhourMapper">
  <resultMap id="BaseResultMap" type="com.course.server.domain.calculate.CalManhour">
    <!--rdms_character-->
    <result column="character_id" jdbcType="CHAR" property="characterId" />
    <result column="customer_id" jdbcType="CHAR" property="customerId" />
    <result column="project_id" jdbcType="CHAR" property="projectId" />
    <result column="subproject_id" jdbcType="CHAR" property="subprojectId" />
    <result column="dev_manhour_approved" jdbcType="INTEGER" property="devCharacterManhour" />
    <result column="test_manhour_approved" jdbcType="INTEGER" property="testCharacterManhour" />
    <!--rdms_job_item-->
    <result column="job_item_id" jdbcType="CHAR" property="jobItemId" />
    <result column="manhour" jdbcType="INTEGER" property="jobItemManhour" />
    <result column="executor_id" jdbcType="CHAR" property="executorId" />
    <!--rdms_manhour_standard-->
    <result column="dev_manhour_fee" jdbcType="DECIMAL" property="devStandardManhourFee" />
    <result column="test_manhour_fee" jdbcType="DECIMAL" property="testStandardManhourFee" />
    <!--rdms_customer_user-->
    <result column="job_level" jdbcType="CHAR" property="jobLevel" />
    <!--rdms_customer_user_job_level-->
    <result column="level_code" jdbcType="VARCHAR" property="userLevelCode" />
    <result column="man_hour_fee" jdbcType="DECIMAL" property="userManHourFee" />
  </resultMap>
<!--
select c.id character_id, c.customer_id, c.project_id, c.subproject_id, c.dev_manhour_approved, c.test_manhour_approved,
           j.id job_item_id, j.manhour,
           s.dev_manhour_fee, s.test_manhour_fee,
           u.user_id, u.job_level,
           l.level_code, l.man_hour_fee
    from `rdms_character` c, `rdms_job_item` j, `rdms_manhour_standard` s, `rdms_customer_user` u, `rdms_customer_user_job_level` l
-->

  <select id="getJobitemManhourInfo" parameterType="java.lang.String" resultMap="BaseResultMap">
    select c.id character_id, c.customer_id, c.project_id, c.subproject_id, c.dev_manhour_approved, c.test_manhour_approved,
    j.id job_item_id, j.manhour, j.executor_id,
    u.job_level,
    s.dev_manhour_fee, s.test_manhour_fee,
    l.man_hour_fee
    from `rdms_job_item` j
    left join `rdms_character` c on j.character_id = c.id
    left join `rdms_customer_user` u on j.executor_id = u.id
    left join `rdms_manhour_standard` s on j.customer_id = s.customer_id
    left join `rdms_customer_user_job_level` l on u.job_level = l.level_code
    WHERE 1=1
    <if test="jobitemId != null and jobitemId != ''">
          and j.id = #{jobitemId}
    </if>
  </select>

</mapper>
