<?xml version="1.0" encoding="UTF-8" ?>
<!--
Author：周朔鹏
编制时间：2025-08-05
电子邮件：391902958@qq.com
项目官网：https://www.euipd.com
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.course.server.mapper.rdms.MyCharacterBudgetMapper" >
    <resultMap id="BaseResultMap" type="com.course.server.dto.rdms.RdmsCharacterBudgetDto">
        <id column="id" jdbcType="CHAR" property="id" />
        <result column="character_serial" jdbcType="CHAR" property="characterSerial" />
        <result column="character_name" jdbcType="CHAR" property="characterName" />
        <result column="customer_id" jdbcType="CHAR" property="customerId" />
        <result column="project_id" jdbcType="CHAR" property="projectId" />
        <result column="subproject_id" jdbcType="CHAR" property="subprojectId" />
        <result column="milestone_id" jdbcType="VARCHAR" property="milestoneId" />
        <result column="product_manager_id" jdbcType="CHAR" property="productManagerId" />
        <result column="dev_manhour" jdbcType="INTEGER" property="devManhour" />
        <result column="dev_manhour_approved" jdbcType="INTEGER" property="devManhourApproved" />
        <result column="test_manhour" jdbcType="INTEGER" property="testManhour" />
        <result column="test_manhour_approved" jdbcType="INTEGER" property="testManhourApproved" />
        <result column="material_fee" jdbcType="DECIMAL" property="materialFee" />
        <result column="material_fee_approved" jdbcType="DECIMAL" property="materialFeeApproved" />
        <result column="test_fee" jdbcType="DECIMAL" property="testFee" />
        <result column="power_fee" jdbcType="DECIMAL" property="powerFee" />
        <result column="conference_fee" jdbcType="DECIMAL" property="conferenceFee" />
        <result column="business_fee" jdbcType="DECIMAL" property="businessFee" />
        <result column="cooperation_fee" jdbcType="DECIMAL" property="cooperationFee" />
        <result column="property_fee" jdbcType="DECIMAL" property="propertyFee" />
        <result column="labor_fee" jdbcType="DECIMAL" property="laborFee" />
        <result column="consulting_fee" jdbcType="DECIMAL" property="consultingFee" />
        <result column="management_fee" jdbcType="DECIMAL" property="managementFee" />
        <result column="sum_other_fee" jdbcType="DECIMAL" property="sumOtherFee" />
    </resultMap>

    <select id="listDecomposeCharacterBudget" parameterType="java.lang.String" resultMap="BaseResultMap">
        select c.id, c.character_serial, c.character_name, c.customer_id, c.project_id, c.subproject_id, c.milestone_id,
               c.product_manager_id, c.dev_manhour, c.dev_manhour_approved, c.test_manhour, c.test_manhour_approved,
               c.material_fee, c.material_fee_approved, c.test_fee,
               c.power_fee, c.conference_fee, c.business_fee, c.cooperation_fee, c.property_fee, c.labor_fee, c.consulting_fee, c.management_fee, sum_other_fee
        from `rdms_character` c
        where 1 = 1
        <if test="parentCharacterId != null and parentCharacterId != ''">
            and c.parent = #{parentCharacterId}
        </if>
    </select>

</mapper>
